<!doctype html><style>html{height:100vh}body{min-height:100vh;display:grid;grid-template-rows:1fr auto}.footer{grid-row-start:2;grid-row-end:3}</style><html lang=en-us><head><meta charset=utf-8><title>sebescudie</title><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description property="og:description" content="Writeup du second lab MEMLABS"><meta name=image property="og:image" content="/"><meta name=author content="seb escudie"><meta name=generator content="Hugo 0.83.1"><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/uikit@3.2.6/dist/css/uikit.min.css><link rel=stylesheet href=/css/style.min.css integrity media=screen><link rel=stylesheet href=/css/syntax.min.css integrity media=screen><script src=https://cdn.jsdelivr.net/npm/mailgo@0.9.14/dist/mailgo.min.js defer></script><link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/favicon-16x16.png><link rel=manifest href=/site.webmanifest></head><body class=blog><div class=wrapper><div uk-sticky="sel-target: .uk-navbar-container; cls-active: uk-navbar-sticky; bottom: #transparent-sticky-navbar"><nav class="uk-navbar-container uk-margin" uk-navbar="mode: click;" style=padding-right:3rem><div class=uk-navbar-right><ul class="uk-navbar-nav uk-visible@s"><li><a style=font-size:18px;text-transform:none href=/>home</a></li><li><a style=font-size:18px;text-transform:none href=/about>about</a></li><li class=uk-active><a style=font-size:18px;text-transform:none href=/blog>blog</a></li><li><a style=font-size:18px;text-transform:none href=/contact>contact</a></li><li><a style=font-size:18px;text-transform:none href=/portfolio>portfolio</a></li></ul><a class="uk-navbar-toggle uk-hidden@s" uk-toggle="target: #sidenav" uk-navbar-toggle-icon href=#></a></div></nav></div><div id=sidenav uk-offcanvas="overlay: true"><div class="uk-offcanvas-bar uk-flex uk-flex-column"><ul class="uk-nav uk-nav-primary uk-nav-center uk-margin-auto-vertical"><li><a style=font-size:18px href>home</a></li><li><a style=font-size:18px href=/about>about</a></li><li class=uk-active><a style=font-size:18px href=/blog>blog</a></li><li><a style=font-size:18px href=/contact>contact</a></li><li><a style=font-size:18px href=/portfolio>portfolio</a></li></ul></div></div><style>p{margin:0}.people-wrap{display:inline-flex;margin-top:10px}.people-image{display:block;border-radius:50%}.people{margin-left:20px;margin-right:20px}.name{margin:auto}h1,h2,h3,h4,h5,h6{color:#000;font-family:Roboto,sans-serif;line-height:1.2;margin-top:2rem}.content img{box-shadow:0 4px 8px rgba(0,0,0,.2),0 6px 20px rgba(0,0,0,.19);display:block;margin-left:auto;margin-right:auto;margin-bottom:30px}.content video{box-shadow:0 4px 8px rgba(0,0,0,.2),0 6px 20px rgba(0,0,0,.19);display:block;margin:0 auto;max-width:60vw;max-height:60vh;margin-bottom:30px}iframe{display:block;margin-left:auto;margin-right:auto;margin-bottom:30px}p{margin-bottom:1em}body p:last-child{margin-bottom:0}img.skills{height:80px}@media only screen and (min-width:960px){.content img{max-width:60vw;max-height:60vh}.content img{max-width:60vw;max-height:60vh}}.content{width:90vw;max-width:1200px}table{font-family:arial,sans-serif;border-collapse:collapse;width:100%}td,th{border:1px solid #ddd;text-align:left;padding:8px}</style><section><div class="uk-container uk-margin-large-bottom uk-margin-medium-top"><h1 class="uk-text-center uk-heading-medium">MEMLABS - LAB02</h1><p class="uk-text-center uk-text-lead">Writeup du second lab MEMLABS</p><hr class=full-width><div class=content><p>Encore un writeup, cette fois-ci sur le second lab du repo <a href=https://github.com/stuxnet999/MemLabs>MEMLABS</a> ! Sans plus attendre, la description du challenge :</p><blockquote><p>One of the clients of our company, lost the access to his system due to an unknown error. He is supposedly a very popular &ldquo;environmental&rdquo; activist. As a part of the investigation, he told us that his go to applications are browsers, his password managers etc. We hope that you can dig into this memory dump and find his important stuff and give it back to us.</p></blockquote><p>Quelles sont nos pistes ? Visiblement, on va avoir affaire à :</p><ul><li>Un browser</li><li>Un gestionnaire de mots de passe</li><li>Le &ldquo;environmental&rdquo; entre guillemets peut-être un indice indiquant qu&rsquo;on va devoir regarder du côté des variables d&rsquo;environnement</li></ul><h1 id=profil>Profil</h1><p>C&rsquo;est parti, commençons par déterminer le profil de notre sample.</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>┌──<span style=color:#f92672>(</span>kali㉿kali<span style=color:#f92672>)</span>-<span style=color:#f92672>[</span>~/Documents/CTF/MEMLABS<span style=color:#f92672>]</span>
└─$ python ~/volatility/volatility-2.6.1/vol.py -f ~/Documents/memory_samples/MemoryDump_Lab2.raw imageinfo
Volatility Foundation Volatility Framework 2.6.1
INFO    : volatility.debug    : Determining profile based on KDBG search...
          Suggested Profile<span style=color:#f92672>(</span>s<span style=color:#f92672>)</span> : Win7SP1x64, Win7SP0x64, Win2008R2SP0x64, Win2008R2SP1x64_24000, Win2008R2SP1x64_23418, Win2008R2SP1x64, Win7SP1x64_24000, Win7SP1x64_23418
<span style=color:#f92672>[</span>...<span style=color:#f92672>]</span>
</code></pre></div><p>Ok, <code>Win7SP1x64</code> it is.</p><h1 id=ctrlshiftesc>CTRL+SHIFT+ESC</h1><p>Regardons maintenant ce qui se passait sur la machine au moment du dump avec <code>pslist</code> :</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>┌──<span style=color:#f92672>(</span>kali㉿kali<span style=color:#f92672>)</span>-<span style=color:#f92672>[</span>~/Documents/CTF/MEMLABS<span style=color:#f92672>]</span>
└─$ python ~/volatility/volatility-2.6.1/vol.py -f ~/Documents/memory_samples/MemoryDump_Lab2.raw --profile<span style=color:#f92672>=</span>Win7SP1x64 pslist
Volatility Foundation Volatility Framework 2.6.1
Offset<span style=color:#f92672>(</span>V<span style=color:#f92672>)</span>          Name                    PID   PPID   Thds     Hnds   Sess  Wow64 Start                          Exit                          
------------------ -------------------- ------ ------ ------ -------- ------ ------ ------------------------------ ------------------------------
0xfffffa8000ca0040 System                    <span style=color:#ae81ff>4</span>      <span style=color:#ae81ff>0</span>     <span style=color:#ae81ff>80</span>      <span style=color:#ae81ff>541</span> ------      <span style=color:#ae81ff>0</span> 2019-12-14 10:35:21 UTC+0000                                 
0xfffffa80014976c0 smss.exe                <span style=color:#ae81ff>248</span>      <span style=color:#ae81ff>4</span>      <span style=color:#ae81ff>3</span>       <span style=color:#ae81ff>37</span> ------      <span style=color:#ae81ff>0</span> 2019-12-14 10:35:21 UTC+0000                                 
0xfffffa80014fdb30 csrss.exe               <span style=color:#ae81ff>320</span>    <span style=color:#ae81ff>312</span>     <span style=color:#ae81ff>10</span>      <span style=color:#ae81ff>446</span>      <span style=color:#ae81ff>0</span>      <span style=color:#ae81ff>0</span> 2019-12-14 10:35:27 UTC+0000                                 
0xfffffa8001c40060 csrss.exe               <span style=color:#ae81ff>368</span>    <span style=color:#ae81ff>360</span>      <span style=color:#ae81ff>8</span>      <span style=color:#ae81ff>237</span>      <span style=color:#ae81ff>1</span>      <span style=color:#ae81ff>0</span> 2019-12-14 10:35:28 UTC+0000                                 
0xfffffa8000ca8840 psxss.exe               <span style=color:#ae81ff>376</span>    <span style=color:#ae81ff>248</span>     <span style=color:#ae81ff>18</span>      <span style=color:#ae81ff>786</span>      <span style=color:#ae81ff>0</span>      <span style=color:#ae81ff>0</span> 2019-12-14 10:35:28 UTC+0000                                 
0xfffffa8001c5a700 winlogon.exe            <span style=color:#ae81ff>416</span>    <span style=color:#ae81ff>360</span>      <span style=color:#ae81ff>6</span>      <span style=color:#ae81ff>112</span>      <span style=color:#ae81ff>1</span>      <span style=color:#ae81ff>0</span> 2019-12-14 10:35:30 UTC+0000                                 
0xfffffa8001c5b2b0 wininit.exe             <span style=color:#ae81ff>424</span>    <span style=color:#ae81ff>312</span>      <span style=color:#ae81ff>3</span>       <span style=color:#ae81ff>75</span>      <span style=color:#ae81ff>0</span>      <span style=color:#ae81ff>0</span> 2019-12-14 10:35:30 UTC+0000                                 
0xfffffa8001c95320 services.exe            <span style=color:#ae81ff>484</span>    <span style=color:#ae81ff>424</span>      <span style=color:#ae81ff>8</span>      <span style=color:#ae81ff>206</span>      <span style=color:#ae81ff>0</span>      <span style=color:#ae81ff>0</span> 2019-12-14 10:35:31 UTC+0000                                 
0xfffffa8001c9d910 lsass.exe               <span style=color:#ae81ff>492</span>    <span style=color:#ae81ff>424</span>      <span style=color:#ae81ff>8</span>      <span style=color:#ae81ff>546</span>      <span style=color:#ae81ff>0</span>      <span style=color:#ae81ff>0</span> 2019-12-14 10:35:31 UTC+0000                                 
0xfffffa8001c9e2d0 lsm.exe                 <span style=color:#ae81ff>500</span>    <span style=color:#ae81ff>424</span>     <span style=color:#ae81ff>10</span>      <span style=color:#ae81ff>181</span>      <span style=color:#ae81ff>0</span>      <span style=color:#ae81ff>0</span> 2019-12-14 10:35:31 UTC+0000                                 
0xfffffa8001cec790 svchost.exe             <span style=color:#ae81ff>588</span>    <span style=color:#ae81ff>484</span>     <span style=color:#ae81ff>12</span>      <span style=color:#ae81ff>354</span>      <span style=color:#ae81ff>0</span>      <span style=color:#ae81ff>0</span> 2019-12-14 10:35:35 UTC+0000                                 
0xfffffa8001d13060 VBoxService.ex          <span style=color:#ae81ff>652</span>    <span style=color:#ae81ff>484</span>     <span style=color:#ae81ff>14</span>      <span style=color:#ae81ff>135</span>      <span style=color:#ae81ff>0</span>      <span style=color:#ae81ff>0</span> 2019-12-14 10:35:36 UTC+0000                                 
0xfffffa8001d4ab30 svchost.exe             <span style=color:#ae81ff>720</span>    <span style=color:#ae81ff>484</span>      <span style=color:#ae81ff>7</span>      <span style=color:#ae81ff>275</span>      <span style=color:#ae81ff>0</span>      <span style=color:#ae81ff>0</span> 2019-12-14 10:35:37 UTC+0000                                 
0xfffffa8001d76320 svchost.exe             <span style=color:#ae81ff>812</span>    <span style=color:#ae81ff>484</span>     <span style=color:#ae81ff>21</span>      <span style=color:#ae81ff>474</span>      <span style=color:#ae81ff>0</span>      <span style=color:#ae81ff>0</span> 2019-12-14 10:35:38 UTC+0000                                 
0xfffffa8001da6930 svchost.exe             <span style=color:#ae81ff>852</span>    <span style=color:#ae81ff>484</span>     <span style=color:#ae81ff>20</span>      <span style=color:#ae81ff>417</span>      <span style=color:#ae81ff>0</span>      <span style=color:#ae81ff>0</span> 2019-12-14 10:35:38 UTC+0000                                 
0xfffffa8001dacb30 svchost.exe             <span style=color:#ae81ff>876</span>    <span style=color:#ae81ff>484</span>     <span style=color:#ae81ff>39</span>      <span style=color:#ae81ff>962</span>      <span style=color:#ae81ff>0</span>      <span style=color:#ae81ff>0</span> 2019-12-14 10:35:38 UTC+0000                                 
0xfffffa8001df65f0 audiodg.exe             <span style=color:#ae81ff>268</span>    <span style=color:#ae81ff>812</span>      <span style=color:#ae81ff>7</span>      <span style=color:#ae81ff>131</span>      <span style=color:#ae81ff>0</span>      <span style=color:#ae81ff>0</span> 2019-12-14 10:35:41 UTC+0000                                 
0xfffffa8001e1eb30 svchost.exe             <span style=color:#ae81ff>472</span>    <span style=color:#ae81ff>484</span>     <span style=color:#ae81ff>12</span>      <span style=color:#ae81ff>301</span>      <span style=color:#ae81ff>0</span>      <span style=color:#ae81ff>0</span> 2019-12-14 10:35:42 UTC+0000                                 
0xfffffa8001e47740 svchost.exe            <span style=color:#ae81ff>1044</span>    <span style=color:#ae81ff>484</span>     <span style=color:#ae81ff>16</span>      <span style=color:#ae81ff>361</span>      <span style=color:#ae81ff>0</span>      <span style=color:#ae81ff>0</span> 2019-12-14 10:35:43 UTC+0000                                 
0xfffffa8000cf9220 spoolsv.exe            <span style=color:#ae81ff>1208</span>    <span style=color:#ae81ff>484</span>     <span style=color:#ae81ff>13</span>      <span style=color:#ae81ff>279</span>      <span style=color:#ae81ff>0</span>      <span style=color:#ae81ff>0</span> 2019-12-14 10:35:47 UTC+0000                                 
0xfffffa8001ed8b30 svchost.exe            <span style=color:#ae81ff>1248</span>    <span style=color:#ae81ff>484</span>     <span style=color:#ae81ff>18</span>      <span style=color:#ae81ff>303</span>      <span style=color:#ae81ff>0</span>      <span style=color:#ae81ff>0</span> 2019-12-14 10:35:49 UTC+0000                                 
0xfffffa8001f4eb30 svchost.exe            <span style=color:#ae81ff>1368</span>    <span style=color:#ae81ff>484</span>     <span style=color:#ae81ff>23</span>      <span style=color:#ae81ff>314</span>      <span style=color:#ae81ff>0</span>      <span style=color:#ae81ff>0</span> 2019-12-14 10:35:51 UTC+0000                                 
0xfffffa8001f7c060 TCPSVCS.EXE            <span style=color:#ae81ff>1412</span>    <span style=color:#ae81ff>484</span>      <span style=color:#ae81ff>4</span>       <span style=color:#ae81ff>97</span>      <span style=color:#ae81ff>0</span>      <span style=color:#ae81ff>0</span> 2019-12-14 10:35:53 UTC+0000                                 
0xfffffa80020f2b30 taskhost.exe           <span style=color:#ae81ff>1928</span>    <span style=color:#ae81ff>484</span>      <span style=color:#ae81ff>9</span>      <span style=color:#ae81ff>154</span>      <span style=color:#ae81ff>1</span>      <span style=color:#ae81ff>0</span> 2019-12-14 10:36:04 UTC+0000                                 
0xfffffa8002105b30 taskeng.exe            <span style=color:#ae81ff>1996</span>    <span style=color:#ae81ff>876</span>      <span style=color:#ae81ff>5</span>       <span style=color:#ae81ff>79</span>      <span style=color:#ae81ff>0</span>      <span style=color:#ae81ff>0</span> 2019-12-14 10:36:04 UTC+0000                                 
0xfffffa800211e7c0 dwm.exe                <span style=color:#ae81ff>2012</span>    <span style=color:#ae81ff>852</span>      <span style=color:#ae81ff>4</span>       <span style=color:#ae81ff>72</span>      <span style=color:#ae81ff>1</span>      <span style=color:#ae81ff>0</span> 2019-12-14 10:36:04 UTC+0000                                 
0xfffffa8002131340 explorer.exe           <span style=color:#ae81ff>1064</span>   <span style=color:#ae81ff>2004</span>     <span style=color:#ae81ff>37</span>      <span style=color:#ae81ff>989</span>      <span style=color:#ae81ff>1</span>      <span style=color:#ae81ff>0</span> 2019-12-14 10:36:05 UTC+0000                                 
0xfffffa80021bb240 SearchIndexer.         <span style=color:#ae81ff>1836</span>    <span style=color:#ae81ff>484</span>     <span style=color:#ae81ff>12</span>      <span style=color:#ae81ff>628</span>      <span style=color:#ae81ff>0</span>      <span style=color:#ae81ff>0</span> 2019-12-14 10:36:11 UTC+0000                                 
0xfffffa80021c0b30 VBoxTray.exe           <span style=color:#ae81ff>1896</span>   <span style=color:#ae81ff>1064</span>     <span style=color:#ae81ff>13</span>      <span style=color:#ae81ff>138</span>      <span style=color:#ae81ff>1</span>      <span style=color:#ae81ff>0</span> 2019-12-14 10:36:13 UTC+0000                                 
0xfffffa80022a3b30 csrss.exe              <span style=color:#ae81ff>2308</span>   <span style=color:#ae81ff>2300</span>      <span style=color:#ae81ff>9</span>      <span style=color:#ae81ff>246</span>      <span style=color:#ae81ff>2</span>      <span style=color:#ae81ff>0</span> 2019-12-14 10:36:24 UTC+0000                                 
0xfffffa80022a73e0 winlogon.exe           <span style=color:#ae81ff>2336</span>   <span style=color:#ae81ff>2300</span>      <span style=color:#ae81ff>4</span>      <span style=color:#ae81ff>109</span>      <span style=color:#ae81ff>2</span>      <span style=color:#ae81ff>0</span> 2019-12-14 10:36:24 UTC+0000                                 
0xfffffa8000e76060 taskhost.exe           <span style=color:#ae81ff>2604</span>    <span style=color:#ae81ff>484</span>      <span style=color:#ae81ff>9</span>      <span style=color:#ae81ff>154</span>      <span style=color:#ae81ff>2</span>      <span style=color:#ae81ff>0</span> 2019-12-14 10:36:29 UTC+0000                                 
0xfffffa8000e95060 dwm.exe                <span style=color:#ae81ff>2652</span>    <span style=color:#ae81ff>852</span>      <span style=color:#ae81ff>3</span>       <span style=color:#ae81ff>71</span>      <span style=color:#ae81ff>2</span>      <span style=color:#ae81ff>0</span> 2019-12-14 10:36:29 UTC+0000                                 
0xfffffa8000e9a110 explorer.exe           <span style=color:#ae81ff>2664</span>   <span style=color:#ae81ff>2632</span>     <span style=color:#ae81ff>19</span>      <span style=color:#ae81ff>632</span>      <span style=color:#ae81ff>2</span>      <span style=color:#ae81ff>0</span> 2019-12-14 10:36:29 UTC+0000                                 
0xfffffa8000edcb30 VBoxTray.exe           <span style=color:#ae81ff>2792</span>   <span style=color:#ae81ff>2664</span>     <span style=color:#ae81ff>12</span>      <span style=color:#ae81ff>139</span>      <span style=color:#ae81ff>2</span>      <span style=color:#ae81ff>0</span> 2019-12-14 10:36:30 UTC+0000                                 
0xfffffa80022e5950 cmd.exe                <span style=color:#ae81ff>2096</span>   <span style=color:#ae81ff>2664</span>      <span style=color:#ae81ff>1</span>       <span style=color:#ae81ff>19</span>      <span style=color:#ae81ff>2</span>      <span style=color:#ae81ff>0</span> 2019-12-14 10:36:35 UTC+0000                                 
0xfffffa8000e63060 conhost.exe            <span style=color:#ae81ff>2068</span>   <span style=color:#ae81ff>2308</span>      <span style=color:#ae81ff>2</span>       <span style=color:#ae81ff>50</span>      <span style=color:#ae81ff>2</span>      <span style=color:#ae81ff>0</span> 2019-12-14 10:36:35 UTC+0000                                 
0xfffffa8002109b30 chrome.exe             <span style=color:#ae81ff>2296</span>   <span style=color:#ae81ff>2664</span>     <span style=color:#ae81ff>27</span>      <span style=color:#ae81ff>658</span>      <span style=color:#ae81ff>2</span>      <span style=color:#ae81ff>0</span> 2019-12-14 10:36:45 UTC+0000                                 
0xfffffa8001cc7a90 chrome.exe             <span style=color:#ae81ff>2304</span>   <span style=color:#ae81ff>2296</span>      <span style=color:#ae81ff>8</span>       <span style=color:#ae81ff>71</span>      <span style=color:#ae81ff>2</span>      <span style=color:#ae81ff>0</span> 2019-12-14 10:36:45 UTC+0000                                 
0xfffffa8000eea7a0 chrome.exe             <span style=color:#ae81ff>2476</span>   <span style=color:#ae81ff>2296</span>      <span style=color:#ae81ff>2</span>       <span style=color:#ae81ff>55</span>      <span style=color:#ae81ff>2</span>      <span style=color:#ae81ff>0</span> 2019-12-14 10:36:46 UTC+0000                                 
0xfffffa8000ea2b30 chrome.exe             <span style=color:#ae81ff>2964</span>   <span style=color:#ae81ff>2296</span>     <span style=color:#ae81ff>13</span>      <span style=color:#ae81ff>295</span>      <span style=color:#ae81ff>2</span>      <span style=color:#ae81ff>0</span> 2019-12-14 10:36:47 UTC+0000                                 
0xfffffa8000fae6a0 chrome.exe             <span style=color:#ae81ff>2572</span>   <span style=color:#ae81ff>2296</span>      <span style=color:#ae81ff>8</span>      <span style=color:#ae81ff>177</span>      <span style=color:#ae81ff>2</span>      <span style=color:#ae81ff>0</span> 2019-12-14 10:36:56 UTC+0000                                 
0xfffffa800105c060 WmiPrvSE.exe           <span style=color:#ae81ff>2636</span>    <span style=color:#ae81ff>588</span>     <span style=color:#ae81ff>12</span>      <span style=color:#ae81ff>293</span>      <span style=color:#ae81ff>0</span>      <span style=color:#ae81ff>0</span> 2019-12-14 10:37:02 UTC+0000                                 
0xfffffa800100c060 WmiApSrv.exe           <span style=color:#ae81ff>2004</span>    <span style=color:#ae81ff>484</span>      <span style=color:#ae81ff>6</span>      <span style=color:#ae81ff>115</span>      <span style=color:#ae81ff>0</span>      <span style=color:#ae81ff>0</span> 2019-12-14 10:37:05 UTC+0000                                 
0xfffffa800230eb30 chrome.exe             <span style=color:#ae81ff>1632</span>   <span style=color:#ae81ff>2296</span>     <span style=color:#ae81ff>14</span>      <span style=color:#ae81ff>219</span>      <span style=color:#ae81ff>2</span>      <span style=color:#ae81ff>0</span> 2019-12-14 10:37:12 UTC+0000                                 
0xfffffa800101e640 dllhost.exe            <span style=color:#ae81ff>2376</span>    <span style=color:#ae81ff>588</span>      <span style=color:#ae81ff>9</span>      <span style=color:#ae81ff>250</span>      <span style=color:#ae81ff>1</span>      <span style=color:#ae81ff>0</span> 2019-12-14 10:37:40 UTC+0000                                 
0xfffffa800224a8c0 KeePass.exe            <span style=color:#ae81ff>3008</span>   <span style=color:#ae81ff>1064</span>     <span style=color:#ae81ff>12</span>      <span style=color:#ae81ff>316</span>      <span style=color:#ae81ff>1</span>      <span style=color:#ae81ff>0</span> 2019-12-14 10:37:56 UTC+0000                                 
0xfffffa8002230b30 sppsvc.exe             <span style=color:#ae81ff>2764</span>    <span style=color:#ae81ff>484</span>      <span style=color:#ae81ff>5</span>      <span style=color:#ae81ff>151</span>      <span style=color:#ae81ff>0</span>      <span style=color:#ae81ff>0</span> 2019-12-14 10:38:00 UTC+0000                                 
0xfffffa80010e5b30 svchost.exe            <span style=color:#ae81ff>1076</span>    <span style=color:#ae81ff>484</span>     <span style=color:#ae81ff>17</span>      <span style=color:#ae81ff>337</span>      <span style=color:#ae81ff>0</span>      <span style=color:#ae81ff>0</span> 2019-12-14 10:38:02 UTC+0000                                 
0xfffffa80010f44a0 wmpnetwk.exe            <span style=color:#ae81ff>928</span>    <span style=color:#ae81ff>484</span>     <span style=color:#ae81ff>18</span>      <span style=color:#ae81ff>523</span>      <span style=color:#ae81ff>0</span>      <span style=color:#ae81ff>0</span> 2019-12-14 10:38:03 UTC+0000                                 
0xfffffa80011956a0 notepad.exe            <span style=color:#ae81ff>3260</span>   <span style=color:#ae81ff>3180</span>      <span style=color:#ae81ff>1</span>       <span style=color:#ae81ff>61</span>      <span style=color:#ae81ff>1</span>      <span style=color:#ae81ff>0</span> 2019-12-14 10:38:20 UTC+0000                                 
0xfffffa80011aa060 DumpIt.exe             <span style=color:#ae81ff>3844</span>   <span style=color:#ae81ff>1064</span>      <span style=color:#ae81ff>2</span>       <span style=color:#ae81ff>45</span>      <span style=color:#ae81ff>1</span>      <span style=color:#ae81ff>1</span> 2019-12-14 10:38:43 UTC+0000                                 
0xfffffa8001194570 conhost.exe            <span style=color:#ae81ff>3852</span>    <span style=color:#ae81ff>368</span>      <span style=color:#ae81ff>2</span>       <span style=color:#ae81ff>52</span>      <span style=color:#ae81ff>1</span>      <span style=color:#ae81ff>0</span> 2019-12-14 10:38:43 UTC+0000                                 
0xfffffa8001189b30 WmiPrvSE.exe           <span style=color:#ae81ff>4004</span>    <span style=color:#ae81ff>588</span>      <span style=color:#ae81ff>9</span>  <span style=color:#ae81ff>1572864</span> ------      <span style=color:#ae81ff>0</span> 2019-12-14 10:39:00 UTC+0000                                 
</code></pre></div><p>On peut ici isoler quelques processes interessants. Notons leurs PID pour plus tard!</p><table><thead><tr><th>Process</th><th>PID</th></tr></thead><tbody><tr><td>KeePass.exe</td><td>3008</td></tr><tr><td>chrome.exe</td><td>1632</td></tr><tr><td>notepad.exe</td><td>3260</td></tr></tbody></table><h1 id=notepad---premier-flag>Notepad - premier flag</h1><p>Je me souviens avoir croisé dans l&rsquo;aide de volatility un plugin qui concernait notepad :</p><pre><code>notepad         List currently displayed notepad text
</code></pre><p>Essayons le sur notre sample, voir si on arrive à extraire quelque chose d&rsquo;intéressant :</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>┌──<span style=color:#f92672>(</span>kali㉿kali<span style=color:#f92672>)</span>-<span style=color:#f92672>[</span>~/Documents/CTF/MEMLABS<span style=color:#f92672>]</span>
└─$ python ~/volatility/volatility-2.6.1/vol.py -f ~/Documents/memory_samples/MemoryDump_Lab2.raw --profile<span style=color:#f92672>=</span>Win7SP1x64 notepad
Volatility Foundation Volatility Framework 2.6.1
ERROR   : volatility.debug    : This command does not support the profile Win7SP1x64
</code></pre></div><p>Bon, visiblement c&rsquo;est non.</p><p>Peut-être qu&rsquo;on peut regarder avec quels args le process a été lancé ?</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>┌──<span style=color:#f92672>(</span>kali㉿kali<span style=color:#f92672>)</span>-<span style=color:#f92672>[</span>~/Documents/CTF/MEMLABS<span style=color:#f92672>]</span>
└─$ python ~/volatility/volatility-2.6.1/vol.py -f ~/Documents/memory_samples/MemoryDump_Lab2.raw --profile<span style=color:#f92672>=</span>Win7SP1x64 cmdline -p <span style=color:#ae81ff>3260</span>                                          <span style=color:#ae81ff>1</span> ⨯
Volatility Foundation Volatility Framework 2.6.1
************************************************************************
notepad.exe pid:   <span style=color:#ae81ff>3260</span>
Command line : <span style=color:#e6db74>&#34;C:\Windows\system32\NOTEPAD.EXE&#34;</span> C:<span style=color:#ae81ff>\U</span>sers<span style=color:#ae81ff>\S</span>martNet<span style=color:#ae81ff>\S</span>ecrets<span style=color:#ae81ff>\H</span>idden.kdbx
</code></pre></div><p>Un fichier Keepass (mais pourquoi avoir cherché à l&rsquo;ouvrir avec notepad ?!) ! Essayons de le récupérer :</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>┌──<span style=color:#f92672>(</span>kali㉿kali<span style=color:#f92672>)</span>-<span style=color:#f92672>[</span>~/Documents/CTF/MEMLABS<span style=color:#f92672>]</span>
└─$ python ~/volatility/volatility-2.6.1/vol.py -f ~/Documents/memory_samples/MemoryDump_Lab2.raw --profile<span style=color:#f92672>=</span>Win7SP1x64 filescan | grep <span style=color:#e6db74>&#34;Hidden.kdbx&#34;</span>
Volatility Foundation Volatility Framework 2.6.1
0x000000003fb112a0     <span style=color:#ae81ff>16</span>      <span style=color:#ae81ff>0</span> R--r-- <span style=color:#ae81ff>\D</span>evice<span style=color:#ae81ff>\H</span>arddiskVolume2<span style=color:#ae81ff>\U</span>sers<span style=color:#ae81ff>\S</span>martNet<span style=color:#ae81ff>\S</span>ecrets<span style=color:#ae81ff>\H</span>idden.kdbx
</code></pre></div><p>Il est bien là.</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>┌──<span style=color:#f92672>(</span>kali㉿kali<span style=color:#f92672>)</span>-<span style=color:#f92672>[</span>~/Documents/CTF/MEMLABS<span style=color:#f92672>]</span>
└─$ python ~/volatility/volatility-2.6.1/vol.py -f ~/Documents/memory_samples/MemoryDump_Lab2.raw --profile<span style=color:#f92672>=</span>Win7SP1x64 dumpfiles -Q 0x000000003fb112a0 -D .                     <span style=color:#ae81ff>1</span> ⨯
Volatility Foundation Volatility Framework 2.6.1
DataSectionObject 0x3fb112a0   None   <span style=color:#ae81ff>\D</span>evice<span style=color:#ae81ff>\H</span>arddiskVolume2<span style=color:#ae81ff>\U</span>sers<span style=color:#ae81ff>\S</span>martNet<span style=color:#ae81ff>\S</span>ecrets<span style=color:#ae81ff>\H</span>idden.kdbx
</code></pre></div><p>Super. Renommons le fichier dumpé en <code>secret.kdbx</code> et essayons de l&rsquo;ouvrir avec KeepassXC.. evidement on nous demande un mot de passe. L&rsquo;intro du CTF mentionnait &ldquo;environment&rdquo;, peut-être que volatility nous permet de lister les varibles d&rsquo;environnement de la machine ?</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>┌──<span style=color:#f92672>(</span>kali㉿kali<span style=color:#f92672>)</span>-<span style=color:#f92672>[</span>~/Documents/CTF/MEMLABS<span style=color:#f92672>]</span>
└─$ python ~/volatility/volatility-2.6.1/vol.py -f ~/Documents/memory_samples/MemoryDump_Lab2.raw --profile<span style=color:#f92672>=</span>Win7SP1x64 envars -p <span style=color:#ae81ff>3008</span>
Volatility Foundation Volatility Framework 2.6.1
Pid      Process              Block              Variable                       Value
-------- -------------------- ------------------ ------------------------------ -----
    <span style=color:#ae81ff>3008</span> KeePass.exe          0x0000000000161320 ALLUSERSPROFILE                C:<span style=color:#ae81ff>\P</span>rogramData
    <span style=color:#ae81ff>3008</span> KeePass.exe          0x0000000000161320 APPDATA                        C:<span style=color:#ae81ff>\U</span>sers<span style=color:#ae81ff>\A</span>lissa Simpson<span style=color:#ae81ff>\A</span>ppData<span style=color:#ae81ff>\R</span>oaming
    <span style=color:#ae81ff>3008</span> KeePass.exe          0x0000000000161320 CommonProgramFiles             C:<span style=color:#ae81ff>\P</span>rogram Files<span style=color:#ae81ff>\C</span>ommon Files
    <span style=color:#ae81ff>3008</span> KeePass.exe          0x0000000000161320 CommonProgramFiles<span style=color:#f92672>(</span>x86<span style=color:#f92672>)</span>        C:<span style=color:#ae81ff>\P</span>rogram Files <span style=color:#f92672>(</span>x86<span style=color:#f92672>)</span><span style=color:#ae81ff>\C</span>ommon Files
    <span style=color:#ae81ff>3008</span> KeePass.exe          0x0000000000161320 CommonProgramW6432             C:<span style=color:#ae81ff>\P</span>rogram Files<span style=color:#ae81ff>\C</span>ommon Files
    <span style=color:#ae81ff>3008</span> KeePass.exe          0x0000000000161320 COMPUTERNAME                   SMARTNET-PC
    <span style=color:#ae81ff>3008</span> KeePass.exe          0x0000000000161320 ComSpec                        C:<span style=color:#ae81ff>\W</span>indows<span style=color:#ae81ff>\s</span>ystem32<span style=color:#ae81ff>\c</span>md.exe
    <span style=color:#ae81ff>3008</span> KeePass.exe          0x0000000000161320 FP_NO_HOST_CHECK               NO
    <span style=color:#ae81ff>3008</span> KeePass.exe          0x0000000000161320 HOMEDRIVE                      C:
    <span style=color:#ae81ff>3008</span> KeePass.exe          0x0000000000161320 HOMEPATH                       <span style=color:#ae81ff>\U</span>sers<span style=color:#ae81ff>\A</span>lissa Simpson
    <span style=color:#ae81ff>3008</span> KeePass.exe          0x0000000000161320 LOCALAPPDATA                   C:<span style=color:#ae81ff>\U</span>sers<span style=color:#ae81ff>\A</span>lissa Simpson<span style=color:#ae81ff>\A</span>ppData<span style=color:#ae81ff>\L</span>ocal
    <span style=color:#ae81ff>3008</span> KeePass.exe          0x0000000000161320 LOGONSERVER                    <span style=color:#ae81ff>\\</span>SMARTNET-PC
    <span style=color:#ae81ff>3008</span> KeePass.exe          0x0000000000161320 NEW_TMP                        C:<span style=color:#ae81ff>\W</span>indows<span style=color:#ae81ff>\Z</span>mxhZ3t3M2xjMG0zX1QwXyRUNGczXyFfT2ZfTDRCXzJ9
    <span style=color:#ae81ff>3008</span> KeePass.exe          0x0000000000161320 NUMBER_OF_PROCESSORS           <span style=color:#ae81ff>1</span>
    <span style=color:#ae81ff>3008</span> KeePass.exe          0x0000000000161320 OS                             Windows_NT
    <span style=color:#ae81ff>3008</span> KeePass.exe          0x0000000000161320 Path                           C:<span style=color:#ae81ff>\W</span>indows<span style=color:#ae81ff>\s</span>ystem32;C:<span style=color:#ae81ff>\W</span>indows;C:<span style=color:#ae81ff>\W</span>indows<span style=color:#ae81ff>\S</span>ystem32<span style=color:#ae81ff>\W</span>bem;C:<span style=color:#ae81ff>\W</span>indows<span style=color:#ae81ff>\S</span>ystem32<span style=color:#ae81ff>\W</span>indowsPowerShell<span style=color:#ae81ff>\v</span>1.0<span style=color:#ae81ff>\
</span><span style=color:#ae81ff></span>    <span style=color:#ae81ff>3008</span> KeePass.exe          0x0000000000161320 PATHEXT                        .COM;.EXE;.BAT;.CMD;.VBS;.VBE;.JS;.JSE;.WSF;.WSH;.MSC
    <span style=color:#ae81ff>3008</span> KeePass.exe          0x0000000000161320 PROCESSOR_ARCHITECTURE         AMD64
    <span style=color:#ae81ff>3008</span> KeePass.exe          0x0000000000161320 PROCESSOR_IDENTIFIER           Intel64 Family <span style=color:#ae81ff>6</span> Model <span style=color:#ae81ff>142</span> Stepping 9, GenuineIntel
    <span style=color:#ae81ff>3008</span> KeePass.exe          0x0000000000161320 PROCESSOR_LEVEL                <span style=color:#ae81ff>6</span>
    <span style=color:#ae81ff>3008</span> KeePass.exe          0x0000000000161320 PROCESSOR_REVISION             8e09
    <span style=color:#ae81ff>3008</span> KeePass.exe          0x0000000000161320 ProgramData                    C:<span style=color:#ae81ff>\P</span>rogramData
    <span style=color:#ae81ff>3008</span> KeePass.exe          0x0000000000161320 ProgramFiles                   C:<span style=color:#ae81ff>\P</span>rogram Files
    <span style=color:#ae81ff>3008</span> KeePass.exe          0x0000000000161320 ProgramFiles<span style=color:#f92672>(</span>x86<span style=color:#f92672>)</span>              C:<span style=color:#ae81ff>\P</span>rogram Files <span style=color:#f92672>(</span>x86<span style=color:#f92672>)</span>
    <span style=color:#ae81ff>3008</span> KeePass.exe          0x0000000000161320 ProgramW6432                   C:<span style=color:#ae81ff>\P</span>rogram Files
    <span style=color:#ae81ff>3008</span> KeePass.exe          0x0000000000161320 PSModulePath                   C:<span style=color:#ae81ff>\W</span>indows<span style=color:#ae81ff>\s</span>ystem32<span style=color:#ae81ff>\W</span>indowsPowerShell<span style=color:#ae81ff>\v</span>1.0<span style=color:#ae81ff>\M</span>odules<span style=color:#ae81ff>\
</span><span style=color:#ae81ff></span>    <span style=color:#ae81ff>3008</span> KeePass.exe          0x0000000000161320 PUBLIC                         C:<span style=color:#ae81ff>\U</span>sers<span style=color:#ae81ff>\P</span>ublic
    <span style=color:#ae81ff>3008</span> KeePass.exe          0x0000000000161320 SESSIONNAME                    Console
    <span style=color:#ae81ff>3008</span> KeePass.exe          0x0000000000161320 SystemDrive                    C:
    <span style=color:#ae81ff>3008</span> KeePass.exe          0x0000000000161320 SystemRoot                     C:<span style=color:#ae81ff>\W</span>indows
    <span style=color:#ae81ff>3008</span> KeePass.exe          0x0000000000161320 TEMP                           C:<span style=color:#ae81ff>\U</span>sers<span style=color:#ae81ff>\A</span>LISSA~1<span style=color:#ae81ff>\A</span>ppData<span style=color:#ae81ff>\L</span>ocal<span style=color:#ae81ff>\T</span>emp
    <span style=color:#ae81ff>3008</span> KeePass.exe          0x0000000000161320 TMP                            C:<span style=color:#ae81ff>\U</span>sers<span style=color:#ae81ff>\A</span>LISSA~1<span style=color:#ae81ff>\A</span>ppData<span style=color:#ae81ff>\L</span>ocal<span style=color:#ae81ff>\T</span>emp
    <span style=color:#ae81ff>3008</span> KeePass.exe          0x0000000000161320 USERDOMAIN                     SmartNet-PC
    <span style=color:#ae81ff>3008</span> KeePass.exe          0x0000000000161320 USERNAME                       Alissa Simpson
    <span style=color:#ae81ff>3008</span> KeePass.exe          0x0000000000161320 USERPROFILE                    C:<span style=color:#ae81ff>\U</span>sers<span style=color:#ae81ff>\A</span>lissa Simpson
    <span style=color:#ae81ff>3008</span> KeePass.exe          0x0000000000161320 windir                         C:<span style=color:#ae81ff>\W</span>indows
    <span style=color:#ae81ff>3008</span> KeePass.exe          0x0000000000161320 windows_tracing_flags          <span style=color:#ae81ff>3</span>
    <span style=color:#ae81ff>3008</span> KeePass.exe          0x0000000000161320 windows_tracing_logfile        C:<span style=color:#ae81ff>\B</span>VTBin<span style=color:#ae81ff>\T</span>ests<span style=color:#ae81ff>\i</span>nstallpackage<span style=color:#ae81ff>\c</span>silogfile.log
</code></pre></div><p>Mh, la variable <code>NEW_TMP</code> est étrange : <code>C:\Windows\ZmxhZ3t3M2xjMG0zX1QwXyRUNGczXyFfT2ZfTDRCXzJ9</code>. On dirait une string en base64, essayons de la décoder :</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>┌──<span style=color:#f92672>(</span>kali㉿kali<span style=color:#f92672>)</span>-<span style=color:#f92672>[</span>~/Documents/CTF/MEMLABS<span style=color:#f92672>]</span>
└─$ echo ZmxhZ3t3M2xjMG0zX1QwXyRUNGczXyFfT2ZfTDRCXzJ9 | base64 --decode
flag<span style=color:#f92672>{</span>w3lc0m3_T0_$T4g3_!_Of_L4B_2<span style=color:#f92672>}</span>
</code></pre></div><p>Et hop, premier flag ! Ceci dit, ce n&rsquo;est pas le mot de passe de notre fichier keepas. J&rsquo;imagine qu&rsquo;on trouvera l&rsquo;info plus tard.</p><p>Ici j&rsquo;ai d&rsquo;abord lancé <code>envars</code> sans PID, mais devant la masse de résultats, j&rsquo;ai filtré avec celui de Keepass, pour voir si quelque chose s&rsquo;en dégageait. On a bien trouvé notre flag mais j&rsquo;avoue ne pas trop comprendre pourquoi cette variable est rattachée au PID en question&mldr;</p><p>Par acquis de conscience, j&rsquo;ai vérifié le résultat de <code>cmdline</code> sur le PID de keepass, on trouve bien le même fichier :</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>┌──<span style=color:#f92672>(</span>kali㉿kali<span style=color:#f92672>)</span>-<span style=color:#f92672>[</span>~/Documents/CTF/MEMLABS<span style=color:#f92672>]</span>
└─$ python ~/volatility/volatility-2.6.1/vol.py -f ~/Documents/memory_samples/MemoryDump_Lab2.raw --profile<span style=color:#f92672>=</span>Win7SP1x64 cmdline -p <span style=color:#ae81ff>3008</span>  
Volatility Foundation Volatility Framework 2.6.1
************************************************************************
KeePass.exe pid:   <span style=color:#ae81ff>3008</span>
Command line : <span style=color:#e6db74>&#34;C:\Program Files (x86)\KeePass Password Safe 2\KeePass.exe&#34;</span> <span style=color:#e6db74>&#34;C:\Users\SmartNet\Secrets\Hidden.kdbx&#34;</span>
</code></pre></div><h1 id=chrome---troisième-flag>Chrome - troisième flag</h1><p>Il était fait mention dans l&rsquo;intro d&rsquo;un navigateur. Dans la liste des process, on tombe sur un <code>chrome.exe</code>. De base, volatility ne dispose d&rsquo;aucun plugin pour extraire des renseignements facilement d&rsquo;un browser (historique de navigation, cookies..), on devrait faire ça à la main. Ceci dit, après une petite recherche, on tombe sur le repo <a href=https://github.com/superponible/volatility-plugins>volatility-plugins</a> de <a href=https://github.com/superponible>superponible</a>, qui propose entre autres un plugin <code>chromehistory</code>, qui nous donne accès à des tas de choses intéressantes sur le browser (historique, cookies, termes de recherche, etc.). Et en effet, c&rsquo;est très simple à utiliser :</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>┌──<span style=color:#f92672>(</span>kali㉿kali<span style=color:#f92672>)</span>-<span style=color:#f92672>[</span>~/Documents/CTF/MEMLABS<span style=color:#f92672>]</span>
└─$ python ~/volatility/volatility-2.6.1/vol.py -f ~/Documents/memory_samples/MemoryDump_Lab2.raw --profile<span style=color:#f92672>=</span>Win7SP1x64 chromehistory  
Volatility Foundation Volatility Framework 2.6.1
Index  URL                                                                              Title                                                                            Visits Typed Last Visit Time            Hidden Favicon ID
------ -------------------------------------------------------------------------------- -------------------------------------------------------------------------------- ------ ----- -------------------------- ------ ----------
    <span style=color:#ae81ff>34</span> https://bi0s.in/                                                                 Amrita Bios                                                                           <span style=color:#ae81ff>1</span>     <span style=color:#ae81ff>1</span> 2019-12-14 10:37:11.596681        N/A       
    <span style=color:#ae81ff>33</span> http://bi0s.in/                                                                  Amrita Bios                                                                           <span style=color:#ae81ff>1</span>     <span style=color:#ae81ff>0</span> 2019-12-14 10:37:11.596681        N/A       
    <span style=color:#ae81ff>32</span> https://mega.nz/#F!TrgSQQTS!H0ZrUzF0B-ZKNM3y9E76lg                               MEGA                                                                                  <span style=color:#ae81ff>2</span>     <span style=color:#ae81ff>0</span> 2019-12-14 10:21:39.602970        N/A       
    <span style=color:#ae81ff>31</span> https://www.ndtv.com/                                                            NDTV: Latest News, India News, Breaking...s, Bollywood, Cricket, Videos &amp; Photos      <span style=color:#ae81ff>1</span>     <span style=color:#ae81ff>1</span> 2019-12-14 10:18:09.449115        N/A       
    <span style=color:#ae81ff>30</span> http://ndtv.com/                                                                 NDTV: Latest News, India News, Breaking...s, Bollywood, Cricket, Videos &amp; Photos      <span style=color:#ae81ff>1</span>     <span style=color:#ae81ff>0</span> 2019-12-14 10:18:09.449115        N/A       
    <span style=color:#ae81ff>28</span> http://blog.bi0s.in/                                                             bi0s                                                                                  <span style=color:#ae81ff>1</span>     <span style=color:#ae81ff>0</span> 2019-12-14 09:41:52.269568        N/A       
    <span style=color:#ae81ff>29</span> https://blog.bi0s.in/                                                            bi0s                                                                                  <span style=color:#ae81ff>1</span>     <span style=color:#ae81ff>1</span> 2019-12-14 10:18:12.073607        N/A       
    <span style=color:#ae81ff>27</span> https://r3xnation.wordpress.com/about/                                           About – R3xNation                                                                   <span style=color:#ae81ff>1</span>     <span style=color:#ae81ff>0</span> 2019-12-14 10:07:31.296539        N/A       
    <span style=color:#ae81ff>26</span> https://www.youtube.com/                                                         YouTube                                                                               <span style=color:#ae81ff>1</span>     <span style=color:#ae81ff>1</span> 2019-12-14 10:04:59.173510        N/A       
    <span style=color:#ae81ff>24</span> http://in.yahoo.com/                                                             Yahoo India | News, Finance, Cricket, Lifestyle and Entertainment                     <span style=color:#ae81ff>1</span>     <span style=color:#ae81ff>0</span> 2019-12-14 09:33:25.210345        N/A       
    <span style=color:#ae81ff>23</span> http://yahoo.in/                                                                 Yahoo India | News, Finance, Cricket, Lifestyle and Entertainment                     <span style=color:#ae81ff>1</span>     <span style=color:#ae81ff>1</span> 2019-12-14 09:33:25.210345        N/A       
    <span style=color:#ae81ff>25</span> https://in.yahoo.com/                                                            Yahoo India | News, Finance, Cricket, Lifestyle and Entertainment                     <span style=color:#ae81ff>2</span>     <span style=color:#ae81ff>0</span> 2019-12-14 09:33:32.266003        N/A       
    <span style=color:#ae81ff>21</span> https://www.bbc.com/sport/football/50780855                                      Jurgen Klopp signs new Liverpool deal <span style=color:#66d9ef>until</span> <span style=color:#ae81ff>2024</span> - BBC Sport                          <span style=color:#ae81ff>1</span>     <span style=color:#ae81ff>0</span> 2019-12-14 09:31:35.842850        N/A       
    <span style=color:#ae81ff>19</span> https://bbc.com/                                                                 BBC - Homepage                                                                        <span style=color:#ae81ff>1</span>     <span style=color:#ae81ff>1</span> 2019-12-14 09:30:55.836868        N/A       
    <span style=color:#ae81ff>18</span> http://bbc.com/                                                                  BBC - Homepage                                                                        <span style=color:#ae81ff>1</span>     <span style=color:#ae81ff>0</span> 2019-12-14 09:30:55.836868        N/A       
    <span style=color:#ae81ff>20</span> https://www.bbc.com/                                                             BBC - Homepage                                                                        <span style=color:#ae81ff>1</span>     <span style=color:#ae81ff>0</span> 2019-12-14 09:30:55.836868        N/A       
    <span style=color:#ae81ff>17</span> https://volatilevirus.home.blog/blog-posts/                                      Blog Posts – Abhiram<span style=color:#e6db74>&#39;s Blog                                                         1     0 2019-12-14 10:07:35.236223        N/A       
</span><span style=color:#e6db74>    16 https://ashutosh1206.github.io/writeups/                                         Writeups | Ashutosh                                                                   1     0 2019-12-14 10:07:32.324863        N/A       
</span><span style=color:#e6db74>    15 https://www.india.com/                                                           Latest India News, Breaking News, Entertainment News | India.com News                 1     1 2019-12-14 09:30:08.206258        N/A       
</span><span style=color:#e6db74>    14 https://www.onlinesbi.com/                                                       State Bank of India                                                                   1     1 2019-12-14 09:29:37.802253        N/A       
</span><span style=color:#e6db74>    12 http://ashutosh1206.github.io/                                                   Home | Ashutosh                                                                       1     0 2019-12-14 09:29:33.876790        N/A       
</span><span style=color:#e6db74>    13 https://ashutosh1206.github.io/                                                  Home | Ashutosh                                                                       1     1 2019-12-14 09:29:33.876790        N/A       
</span><span style=color:#e6db74>    10 http://r3xnation.wordpress.com/                                                  R3xNation – Free Flowing passions                                                   1     0 2019-12-14 09:29:17.212089        N/A       
</span><span style=color:#e6db74>     9 https://volatilevirus.home.blog/                                                 Abhiram&#39;</span>s Blog – Dying Is The Day Worth Living For!!                                <span style=color:#ae81ff>1</span>     <span style=color:#ae81ff>1</span> 2019-12-14 09:27:31.877522        N/A       
     <span style=color:#ae81ff>8</span> http://volatilevirus.home.blog/                                                  Abhiram<span style=color:#960050;background-color:#1e0010>&#39;</span>s Blog – Dying Is The Day Worth Living For!!                                <span style=color:#ae81ff>1</span>     <span style=color:#ae81ff>0</span> 2019-12-14 09:27:31.877522        N/A       
    <span style=color:#ae81ff>11</span> https://r3xnation.wordpress.com/                                                 R3xNation – Free Flowing passions                                                   <span style=color:#ae81ff>1</span>     <span style=color:#ae81ff>1</span> 2019-12-14 09:29:17.212089        N/A       
     <span style=color:#ae81ff>7</span> https://www.facebook.com/                                                        Facebook – log in or sign up                                                        <span style=color:#ae81ff>3</span>     <span style=color:#ae81ff>1</span> 2019-12-14 09:33:15.814086        N/A       
     <span style=color:#ae81ff>4</span> http://bing.com/                                                                 Bing                                                                                  <span style=color:#ae81ff>1</span>     <span style=color:#ae81ff>0</span> 2019-12-14 09:16:18.118193        N/A       
     <span style=color:#ae81ff>6</span> https://www.bing.com/?toWww<span style=color:#f92672>=</span>1&amp;redig<span style=color:#f92672>=</span>2BBD701F84AA44D2A71D870534D085AE             Bing                                                                                  <span style=color:#ae81ff>1</span>     <span style=color:#ae81ff>0</span> 2019-12-14 09:33:00.366479        N/A       
     <span style=color:#ae81ff>5</span> https://bing.com/                                                                Bing                                                                                  <span style=color:#ae81ff>1</span>     <span style=color:#ae81ff>1</span> 2019-12-14 09:16:18.118193        N/A       
     <span style=color:#ae81ff>3</span> https://www.google.com/                                                          Google                                                                                <span style=color:#ae81ff>2</span>     <span style=color:#ae81ff>1</span> 2019-12-14 09:32:52.147284        N/A       
     <span style=color:#ae81ff>2</span> https://chrome.google.com/webstore/category/extensions?hl<span style=color:#f92672>=</span>en                     Chrome Web Store - Extensions                                                         <span style=color:#ae81ff>1</span>     <span style=color:#ae81ff>0</span> 2019-12-14 09:32:53.844597        N/A       
     <span style=color:#ae81ff>1</span> https://chrome.google.com/webstore?hl<span style=color:#f92672>=</span>en                                         Chrome Web Store - Extensions                                                         <span style=color:#ae81ff>1</span>     <span style=color:#ae81ff>0</span> 2019-12-14 09:16:05.724461        N/A       
</code></pre></div><p>Le lien MegaUpload saute directement aux yeux. Voyons ce qui se cache derrière..</p><p><img src=https://raw.githubusercontent.com/sebescudie/sebescudie.github.io/master/static/images/blog/memlab_02/megaupload.png alt></p><p>Une archive <code>Important.zip</code> ! Après l&rsquo;avoir téléchargée, essayons de la déziper :</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>┌──<span style=color:#f92672>(</span>kali㉿kali<span style=color:#f92672>)</span>-<span style=color:#f92672>[</span>~/Downloads<span style=color:#f92672>]</span>
└─$ 7z x Important.zip   

7-Zip <span style=color:#f92672>[</span>64<span style=color:#f92672>]</span> 16.02 : Copyright <span style=color:#f92672>(</span>c<span style=color:#f92672>)</span> 1999-2016 Igor Pavlov : 2016-05-21
<span style=color:#f92672>[</span>...<span style=color:#f92672>]</span>
Comment <span style=color:#f92672>=</span> Password is SHA1<span style=color:#f92672>(</span>stage-3-FLAG<span style=color:#f92672>)</span> from Lab-1. Password is in lowercase.
</code></pre></div><p>Evidement elle est protégée par mot de passe, et on nous indique qu&rsquo;il s&rsquo;agit du SHA1 du troisième flag du premier lab. Si on s&rsquo;en réfère au <a href=https://sebescudie.github.io/blog/memlab_01/>writeup publié sur ce même blog</a>, le troisième flag était <code>flag{w3ll_3rd_stage_was_easy</code>.</p><p>Calculons le SHA1 du flag :</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>┌──<span style=color:#f92672>(</span>kali㉿kali<span style=color:#f92672>)</span>-<span style=color:#f92672>[</span>~/Documents/CTF/MEMLABS<span style=color:#f92672>]</span>
└─$ echo -n flag<span style=color:#f92672>{</span>w3ll_3rd_stage_was_easy<span style=color:#f92672>}</span> | sha1sum                                                                                                                                                                         <span style=color:#ae81ff>127</span> ⨯
6045dd90029719a039fd2d2ebcca718439dd100a  -
</code></pre></div><p>On arrive bien à dézipper l&rsquo;archive en fournissant ce mot de passe, et on obtient le troisième flag !</p><p><img src=https://raw.githubusercontent.com/sebescudie/sebescudie.github.io/master/static/images/blog/memlab_02/flag3.png alt></p><p>Il nous manque maintenant le deuxième &mldr;</p><h1 id=keepass>Keepass</h1><p>Après quelques recherches sur la manière d&rsquo;extraire un master password Keypass d&rsquo;un dump mémoire, je tombe sur <a href=https://blog.bi0s.in/2020/02/09/Forensics/HackTM-FindMyPass/>le writeup d&rsquo;un autre CTF</a> qui donne des informations intéressantes sur le sujet.
Comme le fait remarquer l&rsquo;auteur du writeup (qui semble d&rsquo;ailleurs être la personne qui a créé le CTF que nous sommes en train de faire !), la base de données keepass était ouverte au moment du dump (on avait bien un process <code>keepass.exe</code> en train de tourner, ayant été lancé avec le fichier <code>kdbx</code> qu&rsquo;on a dumpé plus tôt). Ce qui signifie que le master password est probablement quelque part dans la RAM.</p><p>L&rsquo;auteur suggère ensuite de dumper le process en question, et faire un <code>strings</code> dessus pour y trouver le mot de passe. Et bien allons-y !</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>┌──<span style=color:#f92672>(</span>kali㉿kali<span style=color:#f92672>)</span>-<span style=color:#f92672>[</span>~/Documents/CTF/MEMLABS<span style=color:#f92672>]</span>
└─$ python ~/volatility/volatility-2.6.1/vol.py -f ~/Documents/memory_samples/MemoryDump_Lab2.raw --profile<span style=color:#f92672>=</span>Win7SP1x64 memdump -p <span style=color:#ae81ff>3008</span> -D ./memdump 
Volatility Foundation Volatility Framework 2.6.1
************************************************************************
Writing KeePass.exe <span style=color:#f92672>[</span>  3008<span style=color:#f92672>]</span> to 3008.dmp
</code></pre></div><p>On maintenant notre dump, voyons ce que nous dit <code>strings</code>.</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>┌──<span style=color:#f92672>(</span>kali㉿kali<span style=color:#f92672>)</span>-<span style=color:#f92672>[</span>~/Documents/CTF/MEMLABS<span style=color:#f92672>]</span>
└─$ strings ./memdump/3008.dmp &gt; strings.txt
</code></pre></div><p>Après dix siècles de scroll à la recherche d&rsquo;un indice, rien d&rsquo;intéressant. J&rsquo;abandonne la piste du <code>memdump</code> (d&rsquo;autant plus que je ne maitrise pas des masses le sujet) pour tester quelque chose de plus débile : et si notre environmental activist avait noté son mot de passe quelque part sur son ordinateur ? Essayons un <code>filescan</code> avec <code>password</code> &mldr;</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>┌──<span style=color:#f92672>(</span>kali㉿kali<span style=color:#f92672>)</span>-<span style=color:#f92672>[</span>~/Documents/CTF/MEMLABS<span style=color:#f92672>]</span>
└─$ python ~/volatility/volatility-2.6.1/vol.py -f ~/Documents/memory_samples/MemoryDump_Lab2.raw --profile<span style=color:#f92672>=</span>Win7SP1x64 filescan | grep -i <span style=color:#e6db74>&#34;password&#34;</span>
Volatility Foundation Volatility Framework 2.6.1
0x000000003e868370     <span style=color:#ae81ff>16</span>      <span style=color:#ae81ff>0</span> R--r-d <span style=color:#ae81ff>\D</span>evice<span style=color:#ae81ff>\H</span>arddiskVolume2<span style=color:#ae81ff>\P</span>rogram Files <span style=color:#f92672>(</span>x86<span style=color:#f92672>)</span><span style=color:#ae81ff>\K</span>eePass Password Safe 2<span style=color:#ae81ff>\K</span>eePass.exe.config
0x000000003e873070      <span style=color:#ae81ff>8</span>      <span style=color:#ae81ff>0</span> R--r-d <span style=color:#ae81ff>\D</span>evice<span style=color:#ae81ff>\H</span>arddiskVolume2<span style=color:#ae81ff>\P</span>rogram Files <span style=color:#f92672>(</span>x86<span style=color:#f92672>)</span><span style=color:#ae81ff>\K</span>eePass Password Safe 2<span style=color:#ae81ff>\K</span>eePass.exe
0x000000003e8ef2d0     <span style=color:#ae81ff>13</span>      <span style=color:#ae81ff>0</span> R--r-d <span style=color:#ae81ff>\D</span>evice<span style=color:#ae81ff>\H</span>arddiskVolume2<span style=color:#ae81ff>\P</span>rogram Files <span style=color:#f92672>(</span>x86<span style=color:#f92672>)</span><span style=color:#ae81ff>\K</span>eePass Password Safe 2<span style=color:#ae81ff>\K</span>eePass.exe
0x000000003e8f0360      <span style=color:#ae81ff>4</span>      <span style=color:#ae81ff>0</span> R--r-d <span style=color:#ae81ff>\D</span>evice<span style=color:#ae81ff>\H</span>arddiskVolume2<span style=color:#ae81ff>\P</span>rogram Files <span style=color:#f92672>(</span>x86<span style=color:#f92672>)</span><span style=color:#ae81ff>\K</span>eePass Password Safe 2<span style=color:#ae81ff>\K</span>eePass.XmlSerializers.dll
0x000000003eaf7880     <span style=color:#ae81ff>15</span>      <span style=color:#ae81ff>1</span> R--r-d <span style=color:#ae81ff>\D</span>evice<span style=color:#ae81ff>\H</span>arddiskVolume2<span style=color:#ae81ff>\P</span>rogram Files <span style=color:#f92672>(</span>x86<span style=color:#f92672>)</span><span style=color:#ae81ff>\K</span>eePass Password Safe 2<span style=color:#ae81ff>\K</span>eePass.XmlSerializers.dll
0x000000003fb0abc0     <span style=color:#ae81ff>10</span>      <span style=color:#ae81ff>0</span> R--r-d <span style=color:#ae81ff>\D</span>evice<span style=color:#ae81ff>\H</span>arddiskVolume2<span style=color:#ae81ff>\P</span>rogram Files <span style=color:#f92672>(</span>x86<span style=color:#f92672>)</span><span style=color:#ae81ff>\K</span>eePass Password Safe 2<span style=color:#ae81ff>\K</span>eePassLibC64.dll
0x000000003fce1c70      <span style=color:#ae81ff>1</span>      <span style=color:#ae81ff>0</span> R--r-d <span style=color:#ae81ff>\D</span>evice<span style=color:#ae81ff>\H</span>arddiskVolume2<span style=color:#ae81ff>\U</span>sers<span style=color:#ae81ff>\A</span>lissa Simpson<span style=color:#ae81ff>\P</span>ictures<span style=color:#ae81ff>\P</span>assword.png
0x000000003fd62f20      <span style=color:#ae81ff>2</span>      <span style=color:#ae81ff>0</span> R--r-- <span style=color:#ae81ff>\D</span>evice<span style=color:#ae81ff>\H</span>arddiskVolume2<span style=color:#ae81ff>\P</span>rogram Files <span style=color:#f92672>(</span>x86<span style=color:#f92672>)</span><span style=color:#ae81ff>\K</span>eePass Password Safe 2<span style=color:#ae81ff>\K</span>eePass.config.xml
0x000000003fecf820     <span style=color:#ae81ff>15</span>      <span style=color:#ae81ff>0</span> R--r-d <span style=color:#ae81ff>\D</span>evice<span style=color:#ae81ff>\H</span>arddiskVolume2<span style=color:#ae81ff>\P</span>rogram Files <span style=color:#f92672>(</span>x86<span style=color:#f92672>)</span><span style=color:#ae81ff>\K</span>eePass Password Safe 2<span style=color:#ae81ff>\u</span>nins000.exe
</code></pre></div><p>Tiens <code>Password.png</code>&mldr; Une fois encore, essayons d&rsquo;extraire le fichier (je vous fait grâce de la commande cette fois-ci) .. ça fonctionne ! L&rsquo;image nous donne bien le mot de passe, ceci-dit il faudra un tout peut peu chercher dedans ;)</p><p>On fouille maintenant la base données, rien d&rsquo;intéressant à première vue, quelques mots de passe randoms .. Regardons dans la corbeille de la DB Keepass</p><p><img src=https://raw.githubusercontent.com/sebescudie/sebescudie.github.io/master/static/images/blog/memlab_02/keepass_01.png alt></p><p>Quand on double-click sur cette entrée et qu&rsquo;on révèle le mot de passe, bingo, on a notre second flag !</p><p><img src=https://raw.githubusercontent.com/sebescudie/sebescudie.github.io/master/static/images/blog/memlab_02/keepass_02.png alt></p></div><div class=uk-padding-small></div><section><div class=content></div><div class=content></div></section></div></div></section></div><footer class=footer><div class=uk-container><div class="uk-grid-small uk-child-width-1-4@m uk-text-center uk-flex-center uk-margin-medium-bottom" uk-grid><div class=uk-margin-small-bottom><h5 class=uk-margin-small-bottom>Email</h5><a href=mailto:ping%20%7bat%7d%20sebescudie.fr>ping {at} sebescudie.fr</a></div><div><h5 class=uk-margin-small-bottom>Address</h5><div uk-lightbox><a href="https://www.openstreetmap.org/#map=15/48.8283/2.3695" data-caption="paris, fr" data-type=iframe>paris, fr</a></div></div></div><div class="footer-copyright uk-text-center" style=padding-bottom:1rem><img loading=lazy src=https://mirrors.creativecommons.org/presskit/icons/cc.svg style=height:1.2em;width:1.2em alt="Creative Commons">
<img loading=lazy src=https://mirrors.creativecommons.org/presskit/icons/by.svg style=height:1.2em;width:1.2em alt=CC-BY>
2020
seb escudie</div></footer><script src=https://cdn.jsdelivr.net/npm/uikit@3.2.6/dist/js/uikit.min.js></script><script src=https://cdn.jsdelivr.net/npm/uikit@3.2.6/dist/js/uikit-icons.min.js></script></body></html>